<html>
	<head>
		<title>OnSong API: Authentication</title>
		<link rel="stylesheet" type="text/css" href="../assets/styles/default.css"/>
	</head>
	<body>
		<header>
			<div id="logo"/>
		</header>
		<div id="content">
			<h2>Authentication</h2>
			<p>Authentication in the OnSong API requires a permitted user token. This token is generated by the client application and must be 32 characters or more in length.  This is passed as the first path argument with each call to the API that must be authenticated.</p>
			
			<h3>Check authentication</h3>
			<table>
				<tr class="even"><td><strong>URL</strong></td><td><code>/api/&lt;auth_token&gt;/auth</code></td></tr>
				<tr class="odd"><td><strong>Method</strong></td><td><code>GET</code></td></tr>
				<tr class="even"><td><strong>Version</strong></td><td>1.0</td></tr>
			</table>
			
			<h4>Description</h4>
			<p>Tests the authentication status of the user token.</p>
			
			<h4>Path arguments</h4>
			<table>
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Description</th>
						<th>Required</th>
					</tr>
				</thead>
				<tbody>
					<tr class="odd">
						<td><strong>auth_token</strong></td>
						<td>string</td>
						<td>The authentication token used to authenticate the request.</td>
						<td>Required</td>
					</tr>
				</tbody>
			</table>

			<h4>Response</h4>
			<p>Returns a basic response code to determine the success or failure of the operation.</p>
			
			<h4>Response example</h4>
			<p>Success is indicated by the existence of the "success" parameter.</p>
			<pre>{
  "success" : "Token Registered"
}</pre>
			<p>Errors are indicated by the existence of the "error" parameter and can be either "No Token", "Invalid Token Length" or "Not Registered".</p>
			<pre>{
  "error" : "Not Registered"
}</pre>

			<h3>Add user to whitelist</h3>
			<table>
				<tr class="even"><td><strong>URL</strong></td><td><code>/api/&lt;auth_token&gt;/auth</code></td></tr>
				<tr class="odd"><td><strong>Method</strong></td><td><code>PUT</code></td></tr>
				<tr class="even"><td><strong>Version</strong></td><td>1.0</td></tr>
			</table>
			
			<h4>Description</h4>
			<p>
				Registers The authentication token into the API whitelist if the API OnSong instance is accepting new users.
				Call this method if The authentication token was not registered.
			</p>
			
			<h4>Path arguments</h4>
			<table>
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Description</th>
						<th>Required</th>
					</tr>
				</thead>
				<tbody>
					<tr class="odd">
						<td><strong>auth_token</strong></td>
						<td>string</td>
						<td>The authentication token used to authenticate the request.</td>
						<td>Required</td>
					</tr>
				</tbody>
			</table>
			
			<h4>Body arguments</h4>
			<table>
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Description</th>
						<th>Required</th>
					</tr>
				</thead>
				<tbody>
					<tr class="odd">
						<td><strong>name</strong></td>
						<td>string</td>
						<td>The name of the device that is attempting to connect. If omitted, the authentication token is displayed to the end user.</td>
						<td>Optional</td>
					</tr>
				</tbody>
			</table>

			<h4>Response</h4>
			<p>Returns a basic response code to determine the success or failure of the operation.</p>
			
			<h4>Response example</h4>
			<p>Success is indicated by the existence of the "success" parameter with the following values "Token Registered" or "Token Accepted".</p>
			<pre>{
  "success" : "Token Accepted"
}</pre>
			<p>Errors are indicated by the existence of the "error" parameter and can be either "No Token", "Invalid Token Length" or "Not Accepting Users".</p>
			<pre>{
  "error" : "Not Accepting Users
}</pre>

			<h4>Notes</h4>
			<p>If "Not Accepting Users" is returned, the API OnSong instance should prompt the user to accept an incoming connection. Once the user has allowed incoming user authentication requests, this method should be called again to add the user to the whitelist.</p>


			<h3>Delete user from whitelist</h3>
			<table>
				<tr class="even"><td><strong>URL</strong></td><td><code>/api/&lt;auth_token&gt;/auth</code></td></tr>
				<tr class="odd"><td><strong>Method</strong></td><td><code>DELETE</code></td></tr>
				<tr class="even"><td><strong>Version</strong></td><td>1.0</td></tr>
			</table>
			
			<h4>Description</h4>
			<p>
				Removes The authentication token from the API whitelist.
			</p>
			
			<h4>Path arguments</h4>
			<table>
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Description</th>
						<th>Required</th>
					</tr>
				</thead>
				<tbody>
					<tr class="odd">
						<td><strong>auth_token</strong></td>
						<td>string</td>
						<td>The authentication token used to authenticate the request.</td>
						<td>Required</td>
					</tr>
				</tbody>
			</table>

			<h4>Response</h4>
			<p>Returns a basic response code to determine the success or failure of the operation.</p>
			
			<h4>Response example</h4>
			<p>Success is indicated by the existence of the "success" parameter with the following value "Token Unregistered".</p>
			<pre>{
  "success" : "Token Unregistered"
}</pre>
			<p>Errors are indicated by the existence of the "error" parameter and can be either "No Token", "Invalid Token Length" or "Token Not Found".</p>
			<pre>{
  "error" : "Invalid Token Length"
}</pre>

			<h3>Device information</h3>
			<table>
				<tr class="even"><td><strong>URL</strong></td><td><code>/api/&lt;auth_token&gt;/myself</code></td></tr>
				<tr class="odd"><td><strong>Method</strong></td><td><code>GET</code></td></tr>
				<tr class="even"><td><strong>Version</strong></td><td>1.0</td></tr>
			</table>
			
			<h4>Description</h4>
			<p>
				Retrieves information about the current device.
			</p>
			
			<h4>Path arguments</h4>
			<table>
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Description</th>
						<th>Required</th>
					</tr>
				</thead>
				<tbody>
					<tr class="odd">
						<td><strong>auth_token</strong></td>
						<td>string</td>
						<td>The authentication token used to authenticate the request.</td>
						<td>Required</td>
					</tr>
				</tbody>
			</table>

			<h4>Response</h4>
			<p>Returns basic information about the device that is hosting the OnSong Connect services.</p>
			
			<h4>Response example</h4>
			<p>The following information is available about the OnSong Connect server.</p>
			<pre>{
    "name": "My iPad",
    "endpoint": "http://192.168.1.15:5076/api",
    "model": "iPad",
    "token": "01234567-89AB-CDEF-0123-456789ABCDEF"
}</pre>
		</div>
	</body>
	<script src="../assets/scripts/default.js"></script>
</html>